{% extends "base.html" %}

{% block title %}–°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π{% endblock %}

{% block content %}
<h2>–°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π</h2>

<form method="get" class="row g-3 mb-4">
  <div class="col-md-2">
    <label for="created_at" class="form-label">–î–∞—Ç–∞</label>
    <input type="date" name="created_at" id="created_at" class="form-control"
           value="{{ selected_date }}">
  </div>

  <div class="col-md-2">
    <label for="status" class="form-label">–°—Ç–∞—Ç—É—Å</label>
    <select name="status" id="status" class="form-select">
      <option value="">–í—Å–µ</option>
      {% for s in statuses %}
        <option value="{{ s.id }}" {% if selected_status == s.id|stringformat:"s" %}selected{% endif %}>
          {{ s.name }}
        </option>
      {% endfor %}
    </select>
  </div>

  <div class="col-md-2">
    <label for="operation_type" class="form-label">–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏</label>
    <select name="operation_type" id="operation_type" class="form-select">
      <option value="">–í—Å–µ</option>
      {% for t in operation_types %}
        <option value="{{ t.id }}" {% if selected_operation_type == t.id|stringformat:"s" %}selected{% endif %}>
          {{ t.name }}
        </option>
      {% endfor %}
    </select>
  </div>

  <div class="col-md-2">
    <label for="category" class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
    <select name="category" id="category" class="form-select">
      <option value="">–í—Å–µ</option>
      {% for c in categories %}
        <option value="{{ c.id }}" {% if selected_category == c.id|stringformat:"s" %}selected{% endif %}>
          {{ c.name }}
        </option>
      {% endfor %}
    </select>
  </div>

  <div class="col-md-2">
    <label for="subcategory" class="form-label">–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è</label>
    <select name="subcategory" id="subcategory" class="form-select">
      <option value="">–í—Å–µ</option>
      {% for sc in subcategories %}
        <option value="{{ sc.id }}" {% if selected_subcategory == sc.id|stringformat:"s" %}selected{% endif %}>
          {{ sc.name }}
        </option>
      {% endfor %}
    </select>
  </div>

  <div class="col-md-2 align-self-end">
    <button type="submit" class="btn btn-primary w-100">–§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å</button>
    <a href="{% url 'record-list' %}" class="btn btn-secondary w-100 mt-2">–°–±—Ä–æ—Å–∏—Ç—å</a>
  </div>
</form>

<table class="table table-striped table-bordered">
  <thead class="table-dark">
    <tr>
      <th>–î–∞—Ç–∞</th>
      <th>–°—Ç–∞—Ç—É—Å</th>
      <th>–¢–∏–ø</th>
      <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
      <th>–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è</th>
      <th>–°—É–º–º–∞</th>
      <th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    {% for record in records %}
    <tr>
      <td>{{ record.created_at|date:"d.m.Y" }}</td>
      <td>{{ record.status.name }}</td>
      <td>{{ record.operation_type.name }}</td>
      <td>{{ record.category.name }}</td>
      <td>{{ record.subcategory.name }}</td>
      <td>{{ record.amount }}</td>
      <td>{{ record.comment|default:"‚Äî" }}</td>
      <td>
        <a href="{% url 'record-edit' record.pk %}" class="btn btn-sm btn-outline-primary">‚úèÔ∏è</a>
        <a href="{% url 'record-delete' record.pk %}" class="btn btn-sm btn-outline-danger">üóëÔ∏è</a>
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="8" class="text-center">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
